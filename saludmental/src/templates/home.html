{% extends "base.html" %}
{% load i18n %}
{% load static %}

{% block title %}{% trans "Inicio - Be Man Be Woman" %}{% endblock %}

{% block content %}
<!-- Slider de imágenes (100% responsive) -->
<section class="mb-5">
    <div id="homeCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-indicators">
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#homeCarousel" data-bs-slide-to="2" aria-label="Slide 3"></button>
        </div>
        <div class="carousel-inner rounded-4 shadow overflow-hidden">
            <div class="carousel-item active">
                <a class="slide-link" href="{% url 'historias_list' %}">
                    <img src="https://picsum.photos/seed/beman-1/1600/700" class="d-block w-100 object-cover" alt="Historias" fetchpriority="high" decoding="async">
                    <span class="slide-badge"><i class="ri-book-open-line me-1"></i>{% trans 'Historias' %}</span>
                </a>
            </div>
            <div class="carousel-item">
                <a class="slide-link" href="{% url 'agenda_index' %}">
                    <img src="https://picsum.photos/seed/beman-2/1600/700" class="d-block w-100 object-cover" alt="Agenda" decoding="async">
                    <span class="slide-badge"><i class="ri-calendar-event-line me-1"></i>{% trans 'Agenda' %}</span>
                </a>
            </div>
            <div class="carousel-item">
                <a class="slide-link" href="#podcast">
                    <img src="https://picsum.photos/seed/beman-3/1600/700" class="d-block w-100 object-cover" alt="Podcast" decoding="async">
                    <span class="slide-badge"><i class="ri-headphone-line me-1"></i>{% trans 'Podcast' %}</span>
                </a>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#homeCarousel" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">{% trans 'Anterior' %}</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#homeCarousel" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">{% trans 'Siguiente' %}</span>
        </button>
    </div>
    <!-- Se quitó texto de consejo para look más limpio -->
    <style>
        .object-cover { object-fit: cover; height: clamp(220px, 35vw, 460px); }
        .caption-strong { background: linear-gradient(90deg, rgba(13,27,42,.72), rgba(13,27,42,0)); padding: 1.2rem 1.4rem; border-radius: .85rem; }
        .text-shadow { text-shadow: 0 2px 10px rgba(0,0,0,.7); }
        .btn-cta { background: var(--bm-dorado); border: 1px solid var(--bm-dorado); color: #0d1b2a; font-weight: 700; letter-spacing: .2px; box-shadow: 0 8px 24px rgba(212,175,55,.25), 0 0 0 1px rgba(0,0,0,.15) inset; transition: transform .15s ease, box-shadow .2s ease, background .2s ease; }
        .btn-cta:hover { background: var(--bm-dorado-700); color: #0b1626; transform: translateY(-2px); box-shadow: 0 12px 32px rgba(212,175,55,.35), 0 0 0 1px rgba(0,0,0,.2) inset; }
        .btn-cta:active { transform: translateY(0); }
        .btn-cta-outline { background: transparent; border: 1px solid var(--bm-dorado); color: var(--bm-dorado); font-weight: 700; letter-spacing: .2px; transition: transform .15s ease, box-shadow .2s ease, color .2s ease, background .2s ease; }
        .btn-cta-outline:hover { background: rgba(212,175,55,.15); color: var(--bm-dorado-700); transform: translateY(-2px); box-shadow: 0 8px 24px rgba(212,175,55,.25); }
    </style>
</section>

<!-- Eventos (Z-pattern: inmediatamente después del slider) -->
<section id="podcast" class="mb-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="mb-0">{% trans 'Próximos eventos' %}</h2>
        <a href="{% url 'agenda_index' %}" class="btn btn-outline-primary btn-sm">{% trans 'Ver agenda' %}</a>
    </div>
    <div class="row g-4">
        {% for e in eventos %}
            <div class="col-md-6 col-lg-4 d-flex">
                <div class="card w-100 equal-card card-hover">
                    <div class="card-body d-flex align-items-center gap-3">
                        <div class="rounded-circle d-inline-flex align-items-center justify-content-center" style="width:44px; height:44px; background: rgba(212,175,55,.15); color: var(--bm-dorado);">
                            <i class="ri-calendar-event-line fs-5"></i>
                        </div>
                        <div>
                            <div class="fw-semibold">{{ e.nombre }}</div>
                            <div class="text-muted small">{{ e.fecha|date:"d M Y, H:i" }}</div>
                        </div>
                    </div>
                </div>
            </div>
        {% empty %}
            <div class="col-12">
                <p class="text-muted">{% trans 'No hay eventos próximos por ahora.' %}</p>
            </div>
        {% endfor %}
    </div>
</section>

<!-- Historias -->
<section class="mb-5">
    <h2 class="mb-4">{% trans "Historias Destacadas" %}</h2>
    <div class="row g-4">
        {% for historia in historias %}
        <div class="col-md-4 d-flex">
            <div class="card w-100">
                <div class="card-body">
                    <h5 class="card-title">{{ historia.titulo }}</h5>
                    <p class="card-text">{{ historia.contenido|truncatewords:20 }}</p>
                    <p class="text-muted small mb-1">{% trans "Por" %} {{ historia.usuario.username }} - {{ historia.fecha|date:"d M Y" }}</p>
                    <div class="small text-muted">
                        <i class="ri-thumb-up-line"></i> {{ historia.likes_count|default:0 }}
                        &nbsp;·&nbsp;
                        <i class="ri-chat-3-line"></i> {{ historia.comentarios_count|default:0 }}
                    </div>
                </div>
                <div class="card-footer bg-transparent border-0">
                    <a href="{% url 'historia_detalle' historia.pk %}" class="btn btn-outline-primary w-100">{% trans "Leer más" %}</a>
                </div>
            </div>
        </div>
        {% empty %}
        <div class="col-12">
            <p class="text-center text-muted">{% trans "No hay historias publicadas aún." %}</p>
        </div>
        {% endfor %}
    </div>
    <div class="mt-4">
        <a href="{% url 'historias_list' %}" class="btn btn-outline-primary">{% trans "Ver historias" %}</a>
        {% if user.is_authenticated %}
            <a href="{% url 'crear_historia' %}" class="btn btn-primary">{% trans "Escribir historia" %}</a>
        {% endif %}
    </div>
</section>
<section class="mb-5">
    <h2>{% trans 'Escucha Nuestro Podcast En Spotify' %}</h2>
    <div class="ticketmaster-card">
 <iframe data-testid="embed-iframe" style="border-radius:12px" src="https://open.spotify.com/embed/playlist/4aZArQUJF76ZUl9TUaGULI?utm_source=generator&theme=0" width="100%" height="352" frameBorder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>

    <a href="https://open.spotify.com/playlist/4aZArQUJF76ZUl9TUaGULI?si=0e381a91a410441f" target="_blank" class="spotify-btn">
        {% trans 'Abrir en Spotify' %}
    </a>
</div>
</section>
{% endblock %}